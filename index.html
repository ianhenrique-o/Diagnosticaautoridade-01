<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Diagnóstico Estratégico | High-End</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #050505;
      --text: #ffffff;
      --gold: #E6D3A3;
      --accent: rgba(230, 211, 163, 0.4);
      --glass: rgba(255, 255, 255, 0.03);
      --line: rgba(255, 255, 255, 0.08);
      --ease: cubic-bezier(0.23, 1, 0.32, 1);
    }

    * { box-sizing: border-box; -webkit-font-smoothing: antialiased; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: 'Montserrat', sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    /* --- Background Animado (Imersivo) --- */
    .space {
      position: fixed; inset: 0; z-index: -1;
      background: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #050505 100%);
    }

    .nebula {
      position: absolute; inset: -50%;
      background: 
        radial-gradient(circle at 20% 30%, rgba(230,211,163,0.05) 0%, transparent 40%),
        radial-gradient(circle at 80% 70%, rgba(255,255,255,0.03) 0%, transparent 40%);
      filter: blur(80px);
      animation: drift 20s infinite alternate linear;
    }

    @keyframes drift {
      from { transform: rotate(0deg) scale(1); }
      to { transform: rotate(5deg) scale(1.1); }
    }

    /* --- Progress Bar --- */
    .progress-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 4px;
      background: var(--line); z-index: 10;
    }
    #progress-bar {
      height: 100%; width: 0%; background: var(--gold);
      transition: width 0.6s var(--ease);
      box-shadow: 0 0 15px var(--gold);
    }

    /* --- Layout --- */
    .wrap {
      width: 90%;
      max-width: 700px;
      position: relative;
    }

    .slide {
      display: none;
      animation: fadeIn 0.8s var(--ease) forwards;
    }

    .slide.active { display: block; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); filter: blur(10px); }
      to { opacity: 1; transform: translateY(0); filter: blur(0); }
    }

    h1 {
      font-size: clamp(1.8rem, 5vw, 2.8rem);
      font-weight: 300;
      line-height: 1.2;
      margin-bottom: 2rem;
      letter-spacing: -0.03em;
    }

    h1 strong { font-weight: 600; color: var(--gold); }

    .p {
      font-size: 1.1rem;
      color: rgba(255,255,255,0.6);
      line-height: 1.6;
      margin-bottom: 2rem;
    }

    /* --- Inputs & Choices --- */
    .field-group { margin-top: 2rem; }

    .input-main {
      width: 100%;
      background: transparent;
      border: none;
      border-bottom: 2px solid var(--line);
      padding: 1rem 0;
      font-size: 1.5rem;
      color: var(--gold);
      outline: none;
      transition: border-color 0.4s var(--ease);
      font-family: inherit;
    }

    .input-main:focus { border-bottom-color: var(--gold); }

    .options {
      display: grid;
      gap: 12px;
      margin-top: 1rem;
    }

    .opt {
      background: var(--glass);
      border: 1px solid var(--line);
      padding: 1.2rem;
      border-radius: 12px;
      color: rgba(255,255,255,0.8);
      text-align: left;
      cursor: pointer;
      transition: all 0.3s var(--ease);
      font-size: 1rem;
      font-family: inherit;
    }

    .opt:hover { background: rgba(255,255,255,0.06); border-color: var(--accent); }
    .opt.selected { 
      background: var(--gold); 
      color: #000; 
      border-color: var(--gold);
      font-weight: 600;
      transform: scale(1.02);
    }

    /* --- Botões --- */
    .btn-wrap { margin-top: 3rem; }

    .btn {
      background: var(--gold);
      color: #000;
      border: none;
      padding: 1.2rem 3rem;
      border-radius: 100px;
      font-weight: 600;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      cursor: pointer;
      transition: all 0.3s var(--ease);
      box-shadow: 0 10px 30px rgba(230,211,163,0.2);
    }

    .btn:hover { transform: translateY(-3px); box-shadow: 0 15px 40px rgba(230,211,163,0.4); opacity: 0.95; }
    .btn:active { transform: translateY(0); }

    .btn-secondary {
      background: transparent;
      color: var(--gold);
      border: 1px solid var(--accent);
      margin-right: 1rem;
    }

    /* Erro */
    .shake { animation: shake 0.4s var(--ease); }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    @media (max-width: 600px) {
      h1 { font-size: 1.5rem; }
      .input-main { font-size: 1.2rem; }
    }
  </style>
</head>

<body>
  <div class="space"><div class="nebula"></div></div>
  <div class="progress-container"><div id="progress-bar"></div></div>

  <main class="wrap">
    <section id="intro" class="slide active">
      <h1>Diagnóstico Estratégico de <strong>Posicionamento Digital</strong></h1>
      <p class="p">Para profissionais de autoridade que buscam alinhar sua presença digital ao nível de sua excelência offline.</p>
      <div class="btn-wrap">
        <button class="btn" onclick="start()">Começar Diagnóstico</button>
      </div>
    </section>

    <section id="form-step" class="slide">
      <h1 id="question-label">Carregando...</h1>
      <div id="field-area"></div>
      <div class="btn-wrap">
        <button class="btn" id="next-btn">Próximo</button>
      </div>
    </section>

    <section id="final" class="slide">
      <h1>Análise em <strong>Processamento</strong></h1>
      <p class="p">Obrigado pela confiança. Caso seu perfil seja selecionado, entrarei em contato via WhatsApp para os próximos passos.</p>
    </section>
  </main>

  <script>
    const ENDPOINT_URL = "https://script.google.com/macros/s/AKfycbyQ2mk3W98Yj6NVXPPrgAvYQt4I7vo31eida1jh9kHcypsmm1EZyPngn220XNWWKI_NyA/exec"; // Mantenha sua URL do Apps Script

    const QUESTIONS = [
      { id:"nome", label:"Qual seu **nome completo**?", type:"text", required:true, kind:"input" },
      { id:"area", label:"Qual sua **área de atuação**?", type:"text", required:true, kind:"input" },
      { id:"tempo", label:"Há quanto **tempo** atua no mercado?", type:"text", required:true, kind:"input" },
      {
        id:"momento",
        label:"Qual situação melhor descreve seu **momento atual**?",
        required:true,
        kind:"choice",
        options:[
          "Meu posicionamento não acompanha o nível do meu serviço",
          "Meu perfil parece genérico perto da concorrência",
          "Atraio o público errado (curiosos)",
          "Tenho autoridade offline, mas sou invisível no digital"
        ]
      },
      { id:"perfil", label:"Qual o seu **@ do Instagram**?", type:"text", required:true, kind:"input" },
      { id:"problema", label:"Qual seu maior **obstáculo** hoje?", type:"text", required:true, kind:"input" },
      { id:"ticket", label:"Qual seu **ticket médio** hoje?", type:"text", required:true, kind:"input" },
      { id:"porque", label:"Por que este é o **momento certo** para mudar?", type:"text", required:true, kind:"input" },
      {
        id:"invest",
        label:"Quanto pretende **investir mensalmente** no seu posicionamento?",
        required:true,
        kind:"choice",
        options:[
          "R$ 1.500 – R$ 3.000/mês",
          "R$ 3.000 – R$ 7.000/mês",
          "R$ +7.000/mês"
        ]
      },
      { id:"whatsapp", label:"Seu melhor **WhatsApp** (com DDD):", type:"tel", required:true, kind:"input" }
    ];

    let currentStep = 0;
    const answers = {};

    function updateProgress() {
      const percent = (currentStep / QUESTIONS.length) * 100;
      document.getElementById('progress-bar').style.width = percent + '%';
    }

    function start() {
      showStep('form-step');
      renderQuestion();
    }

    function renderQuestion() {
      updateProgress();
      const q = QUESTIONS[currentStep];
      const labelEl = document.getElementById('question-label');
      const areaEl = document.getElementById('field-area');
      
      // Formata o label (suporta asteriscos para negrito)
      labelEl.innerHTML = q.label.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
      areaEl.innerHTML = '';

      if (q.kind === 'choice') {
        const group = document.createElement('div');
        group.className = 'options';
        q.options.forEach(opt => {
          const b = document.createElement('button');
          b.className = 'opt' + (answers[q.id] === opt ? ' selected' : '');
          b.textContent = opt;
          b.onclick = () => {
            answers[q.id] = opt;
            [...group.children].forEach(c => c.classList.remove('selected'));
            b.classList.add('selected');
            setTimeout(next, 400); // Auto-next suave
          };
          group.appendChild(b);
        });
        areaEl.appendChild(group);
      } else {
        const input = document.createElement('input');
        input.className = 'input-main';
        input.type = q.type;
        input.placeholder = 'Escreva aqui...';
        input.value = answers[q.id] || '';
        input.onkeydown = (e) => { if(e.key === 'Enter') next(); };
        areaEl.appendChild(input);
        setTimeout(() => input.focus(), 400);
      }
    }

    function next() {
      const q = QUESTIONS[currentStep];
      let val = answers[q.id];

      if (q.kind === 'input') {
        val = document.querySelector('.input-main').value.trim();
        answers[q.id] = val;
      }

      if (q.required && !val) {
        document.getElementById('form-step').classList.add('shake');
        setTimeout(() => document.getElementById('form-step').classList.remove('shake'), 400);
        return;
      }

      if (currentStep < QUESTIONS.length - 1) {
        currentStep++;
        const el = document.getElementById('form-step');
        el.style.animation = 'none';
        void el.offsetWidth;
        el.style.animation = 'fadeIn 0.6s var(--ease) forwards';
        renderQuestion();
      } else {
        finish();
      }
    }

    function showStep(id) {
      document.querySelectorAll('.slide').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    async function finish() {
      showStep('final');
      updateProgress();
      document.getElementById('progress-bar').style.width = '100%';

      const payload = { submittedAt: new Date().toLocaleString(), ...answers };
      
      try {
        await fetch(ENDPOINT_URL, {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: new URLSearchParams(payload).toString()
        });
      } catch(e) { console.error("Erro no envio", e); }
    }

    document.getElementById('next-btn').addEventListener('click', next);
  </script>
</body>
</html>
